function Keyboard() {}

function createKeyboard(a, b) {
    var c = new Keyboard;
    return c.prevkey = 32, c.ppkey = 32, c.hidden = !1, c.posChanged = !0, c.isEng = !1, c.previousCons = !1, c.previouspreviousCons = !1, c.pVowel = !1, c.pppC = !1, c.isHinLetter = !1, c.elemID = a, c.lang = b, c
}

function initKBD(a, b) {
    keyboards[a] = createKeyboard(a, b)
}

function changeCursor(a) {
    a.createTextRange && (a.cursorPos = document.selection.createRange().duplicate())
}

function changePhonetic(a, b) {
    var c = document.getElementById(b.elemID),
        d = 0,
        e = "",
        g = a;
    if (g.altKey || g.ctrlKey) return !0;
    var h = 0,
        i = "",
        k = 0,
        l = 0;
    if (h = document.all ? g.keyCode : g.which, null == h && (h = a.keyCode ? a.keyCode : a.which), 32 > h || h >= 33 && 47 >= h || h >= 59 && 64 >= h || h >= 91 && 96 >= h && 94 != h || h >= 123 && 127 >= h && 126 != h || h > 255) return ClearAllParameters(b), !0;
    switch (i = String.fromCharCode(h), b.posChanged && (b.prevkey = 32, b.hidden = !1, l = 0, b.previousCons = !1, b.previouspreviousCons = !1, b.pppC = !1), i) {
        case "a":
            var m = GetConsComb(b.prevkey, h),
                n = GetVowelCombination(b.prevkey, h);
            b.pVowel = !0, b.previousCons ? (d = 0, e = Cons[h], b.isHinLetter = !0) : "undefined" != typeof n ? (b.previouspreviousCons ? (d = 0, e = m) : (d--, e = n), b.isHinLetter = !1) : (d = 0, e = Vowel[h], b.isHinLetter = !1), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1;
            break;
        case "e":
        case "i":
        case "o":
        case "u":
        case "A":
        case "I":
        case "U":
        case "O":
        case "E":
            var m = GetConsComb(b.prevkey, h),
                n = GetVowelCombination(b.prevkey, h);
            b.pVowel = !0, b.isHinLetter = !1, b.previousCons ? (d = 0, e = Cons[h]) : "undefined" != typeof n ? b.previouspreviousCons ? (b.prevkey != h ? d = 0 : d -= 1, e = m) : (d--, e = n) : (d = 0, e = Vowel[h]), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1;
            break;
        case "R":
            b.previousCons ? (d = 0, e = Cons[VRU]) : (d = 0, e = Vowel[h]), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1, b.prevkey = h, b.pVowel = !0, b.isHinLetter = !1;
            break;
        case "~":
            d = 0, e = "~", b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1, prevchar = i, b.pVowel = !0, b.isHinLetter = !1;
            break;
        case "^":
            126 == b.prevkey ? (d -= 1, e = "^") : b.previousCons ? e = Cons[VIRAM] + Cons[ZWJ] : b.prevkey == h ? (d -= 2, e = Cons[VIRAM] + Cons[ZWNJ]) : e = "^", b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1, prevchar = i, b.isHinLetter = !1;
            break;
        case "M":
            126 != b.prevkey ? (d = 0, e = Cons[h]) : (d -= 1, e = Cons[94]), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1, prevchar = b.keychar, b.pVowel = !0, b.isHinLetter = !1;
            break;
        case " ":
            if (b.pVowel = !1, 32 == b.prevkey) return;
            d = 0, e = Numeric[h], b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1, b.hidden = !1, b.ppkey = b.prevkey, b.prevkey = h, b.isHinLetter = !1;
            break;
        default:
            var m = GetConsComb(b.prevkey, h);
            b.pVowel = !1, b.isHinLetter = !1, b.hidden ? "undefined" != typeof m ? (d = 0, e = b.previouspreviousCons ? Cons[VIRAM] + m : m, ClearAllParameters(b), b.previouspreviousCons = !1, b.pppC = !1, b.previousCons = !0) : "undefined" != typeof Cons[h] ? (d = 0, e = b.previousCons && !b.previouspreviousCons ? Cons[VIRAM] + Cons[h] : Cons[h], ClearAllParameters(b), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !0, b.hidden = !1) : (d = 0, b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1) : "undefined" != typeof m ? (d -= 1, e = m, ClearAllParameters(b), b.pppC = b.previouspreviousCons, b.previouspreviousCons = !1, b.previousCons = !0) : "undefined" != typeof Cons[h] ? (d = 0, e = b.previousCons && !b.previouspreviousCons ? Cons[VIRAM] + Cons[h] : Cons[h], ClearAllParameters(b), b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !0) : "undefined" != typeof Numeric[h] ? (d = 0, e = Numeric[h], b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !1) : (b.pppC = b.previouspreviousCons, b.previouspreviousCons = b.previousCons, b.previousCons = !0, b.hidden = !0)
    }
    if (b.ppkey = b.prevkey, b.prevkey = h, c.setSelectionRange) {
        k = c.selectionStart;
        var o = c.value.substring(0, k + d),
            p = c.value.substring(k, c.value.length),
            q = c.scrollTop;
        l = "undefined" != typeof e ? k + d + e.length : k + d, c.value = o + e + p, c.scrollTop = q, c.focus(), c.setSelectionRange(l, l)
    } else if (c.createTextRange && c.cursorPos) {
        var r = c.cursorPos;
        r.moveStart("character", d), r.text = " " == r.text.charAt(r.text.length - 1) ? e + " " : e, r.collapse(!1), r.scrollIntoView(!0)
    } else 0 == d ? c.value += e : c.value = c.value.substring(0, c.value.length - 1) + e;
    return c.focus(), b.posChanged = !1, !1
}

function changeInscript(a, b) {
    var c = "",
        d = document.getElementById(b.elemID);
    if (!a.altKey && !a.ctrlKey) {
        var e = 0,
            f = "",
            g = 0,
            h = 0,
            i = 0;
        if (e = a.keyCode ? a.keyCode : a.charCode, 0 == a.shiftKey && 0 == Keyboard.capsLock && e >= 65 && 90 >= e && (e += 32), 1 == a.shiftKey && 1 == Keyboard.capsLock && e >= 65 && 90 >= e && (e += 32), 1 == a.shiftKey) switch (e) {
            case 51:
                e = 35;
                break;
            case 53:
                e = 37;
                break;
            case 54:
                e = 93;
                break;
            case 55:
                e = 38;
                break;
            case 56:
                e = 42;
                break;
            case 57:
                e = 40;
                break;
            case 48:
                e = 41;
                break;
            case 186:
                e = 58;
                break;
            case 187:
                e = 43;
                break;
            case 188:
                e = 60;
                break;
            case 189:
                e = 95;
                break;
            case 190:
                e = 62;
                break;
            case 191:
                e = 63;
                break;
            case 192:
                e = 126;
                break;
            case 219:
                e = 123;
                break;
            case 221:
                e = 125;
                break;
            case 222:
                e = 34
        } else switch (e) {
            case 186:
                e = 59;
                break;
            case 187:
                e = 61;
                break;
            case 188:
                e = 44;
                break;
            case 189:
                e = 45;
                break;
            case 190:
                e = 46;
                break;
            case 191:
                e = 47;
                break;
            case 192:
                e = 96;
                break;
            case 219:
                e = 91;
                break;
            case 220:
                e = 92;
                break;
            case 221:
                e = 93;
                break;
            case 222:
                e = 39
        }
        if (1 == a.shiftKey && e >= 48 && 57 >= e && (e -= 16), !(32 > e || e >= 40 && 41 >= e || 64 === e || e > 93 && 96 >= e && 94 != e || 127 === e && 126 != e || e > 255)) {
            if (8 != e && d.focus(), c = inscriptChars[e], f = String.fromCharCode(e), d && null != c) {
                g = d.selectionStart;
                var j = d.value.substring(0, g + h),
                    k = d.value.substring(g, d.value.length);
                i = void 0 != typeof c ? g + h + c.length : g + h, d.value = j + c + k, d.setSelectionRange(i, i)
            }
            return !1
        }
    }
}

function ClearAllParameters(a) {
    a.prevkey = 32, a.hidden = !1, a.posChanged = !0, a.previousCons = !1, a.previouspreviousCons = !1, a.pppC = !1, a.pVowel = !1, a.isHinLetter = !1
}

function ClearAllParameters() {
    prevkey = 32, hidden = !1, posChanged = !0, previousCons = !1, previouspreviousCons = !1, pppC = !1, pVowel = !1, isHinLetter = !1
}

function GetVowelCombination(a, b) {
    var c = 0;
    for (c = 0; c < VowelCombination.length; c++)
        if (VowelCombination[c][0] == a && VowelCombination[c][1] == b) return VowelCombination[c][2]
}

function GetConsComb(a, b) {
    var c = 0;
    for (c = 0; c < consComb.length; c++)
        if (consComb[c][0] == a && consComb[c][1] == b) return consComb[c][2]
}

function handleKeyPress(a, b) {
    return "phonetic" === $("#selectKBD")[0].value ? changePhonetic(a, b) : "inscript" === $("#selectKBD")[0].value ? changeInscript(a, b) : !0
}
var Vowel = new Array(123),
    VowelCombination = new Array(6),
    Cons = new Array(123),
    consComb = new Array(27),
    Numeric = new Array(60),
    VIRAM = 1,
    VRU = 2,
    RU = 3,
    ZWJ = 4,
    ZWNJ = 5;
Numeric[32] = " ", Numeric[58] = "\u0b03", Numeric[48] = "\u0b66", Numeric[49] = "\u0b67", Numeric[50] = "\u0b68", Numeric[51] = "\u0b69", Numeric[52] = "\u0b6a", Numeric[53] = "\u0b6b", Numeric[54] = "\u0b6c", Numeric[55] = "\u0b6d", Numeric[56] = "\u0b6e", Numeric[57] = "\u0b6f", Vowel[97] = "\u0b05", Vowel[65] = "\u0b06", Vowel[105] = "\u0b07", Vowel[73] = "\u0b08", Vowel[117] = "\u0b09", Vowel[85] = "\u0b0a", Vowel[82] = "\u0b0b", Vowel[69] = "\u0b0d", Vowel[101] = "\u0b0f", Vowel[79] = "\u0b11", Vowel[111] = "\u0b13", VowelCombination[0] = new Array(3), VowelCombination[0][0] = 97, VowelCombination[0][1] = 97, VowelCombination[0][2] = "\u0b06", VowelCombination[1] = new Array(3), VowelCombination[1][0] = 101, VowelCombination[1][1] = 101, VowelCombination[1][2] = "\u0b08", VowelCombination[2] = new Array(3), VowelCombination[2][0] = 111, VowelCombination[2][1] = 111, VowelCombination[2][2] = "\u0b0a", VowelCombination[3] = new Array(3), VowelCombination[3][0] = 82, VowelCombination[3][1] = 85, VowelCombination[3][2] = "\u0b0b", VowelCombination[4] = new Array(3), VowelCombination[4][0] = 97, VowelCombination[4][1] = 105, VowelCombination[4][2] = "\u0b10", VowelCombination[5] = new Array(3), VowelCombination[5][0] = 97, VowelCombination[5][1] = 117, VowelCombination[5][2] = "\u0b14", Cons[94] = "\u0b01", Cons[77] = "\u0b02", Cons[107] = "\u0b15", Cons[103] = "\u0b17", Cons[106] = "\u0b1c", Cons[122] = "\u0b1d", Cons[84] = "\u0b1f", Cons[68] = "\u0b21", Cons[78] = "\u0b23", Cons[116] = "\u0b24", Cons[100] = "\u0b26", Cons[110] = "\u0b28", Cons[112] = "\u0b2a", Cons[102] = "\u0b2b", Cons[98] = "\u0b2c", Cons[109] = "\u0b2e", Cons[121] = "\u0b2f", Cons[114] = "\u0b30", Cons[108] = "\u0b32", Cons[76] = "\u0b33", Cons[118] = "\u0b35", Cons[119] = "\u0b35", Cons[115] = "\u0b38", Cons[120] = "\u0b15\u0b4d\u0b37", Cons[104] = "\u0b39", Cons[97] = "", Cons[VIRAM] = "\u0b4d", Cons[ZWJ] = "\u200d", Cons[ZWNJ] = "\u200c", Cons[65] = "\u0b3e", Cons[105] = "\u0b3f", Cons[73] = "\u0b40", Cons[117] = "\u0b41", Cons[85] = "\u0b42", Cons[VRU] = "\u0b43", Cons[69] = "\u0b45", Cons[101] = "\u0b47", Cons[79] = "\u0b49", Cons[111] = "\u0b4b", Cons[75] = "\u0b58", Cons[71] = "\u0b5a", Cons[90] = "\u0b5b", Cons[70] = "\u0b5e", Cons[89] = "\u0b5f", consComb[0] = new Array(3), consComb[0][0] = 107, consComb[0][1] = 104, consComb[0][2] = "\u0b16", consComb[1] = new Array(3), consComb[1][0] = 103, consComb[1][1] = 104, consComb[1][2] = "\u0b18", consComb[2] = new Array(3), consComb[2][0] = 99, consComb[2][1] = 104, consComb[2][2] = "\u0b1a", consComb[3] = new Array(3), consComb[3][0] = 67, consComb[3][1] = 104, consComb[3][2] = "\u0b1b", consComb[4] = new Array(3), consComb[4][0] = 84, consComb[4][1] = 104, consComb[4][2] = "\u0b20", consComb[5] = new Array(3), consComb[5][0] = 68, consComb[5][1] = 104, consComb[5][2] = "\u0b22", consComb[6] = new Array(3), consComb[6][0] = 116, consComb[6][1] = 104, consComb[6][2] = "\u0b25", consComb[7] = new Array(3), consComb[7][0] = 100, consComb[7][1] = 104, consComb[7][2] = "\u0b27", consComb[8] = new Array(3), consComb[8][0] = 112, consComb[8][1] = 104, consComb[8][2] = "\u0b2b", consComb[9] = new Array(3), consComb[9][0] = 98, consComb[9][1] = 104, consComb[9][2] = "\u0b2d", consComb[10] = new Array(3), consComb[10][0] = 115, consComb[10][1] = 104, consComb[10][2] = "\u0b36", consComb[11] = new Array(3), consComb[11][0] = 83, consComb[11][1] = 104, consComb[11][2] = "\u0b37", consComb[12] = new Array(3), consComb[12][0] = 74, consComb[12][1] = 104, consComb[12][2] = "\u0b1c\u0b4d\u0b1e", consComb[13] = new Array(3), consComb[13][0] = 97, consComb[13][1] = 97, consComb[13][2] = "\u0b3e", consComb[14] = new Array(3), consComb[14][0] = 101, consComb[14][1] = 101, consComb[14][2] = "\u0b40", consComb[15] = new Array(3), consComb[15][0] = 111, consComb[15][1] = 111, consComb[15][2] = "\u0b42", consComb[16] = new Array(3), consComb[16][0] = 97, consComb[16][1] = 105, consComb[16][2] = "\u0b48", consComb[17] = new Array(3), consComb[17][0] = 97, consComb[17][1] = 117, consComb[17][2] = "\u0b4c", consComb[18] = new Array(3), consComb[18][0] = 78, consComb[18][1] = 71, consComb[18][2] = "\u0b19", consComb[19] = new Array(3), consComb[19][0] = 78, consComb[19][1] = 89, consComb[19][2] = "\u0b1e", consComb[20] = new Array(3), consComb[20][0] = 75, consComb[20][1] = 104, consComb[20][2] = "\u0b59", consComb[21] = new Array(3), consComb[21][0] = 68, consComb[21][1] = 68, consComb[21][2] = "\u0b5c", consComb[22] = new Array(3), consComb[22][0] = 68, consComb[22][1] = 72, consComb[22][2] = "\u0b5d", consComb[23] = new Array(3), consComb[23][0] = 78, consComb[23][1] = 78, consComb[23][2] = "\u0b29", consComb[24] = new Array(3), consComb[24][0] = 82, consComb[24][1] = 82, consComb[24][2] = "\u0b31", consComb[25] = new Array(3), consComb[25][0] = 76, consComb[25][1] = 76, consComb[25][2] = "\u0b34", consComb[26] = new Array(3), consComb[26][0] = 106, consComb[26][1] = 104, consComb[26][2] = "\u0b1d";
var inscriptChars = [];
inscriptChars[68] = "\u0b05", inscriptChars[69] = "\u0b06", inscriptChars[70] = "\u0b07", inscriptChars[82] = "\u0b08", inscriptChars[71] = "\u0b09", inscriptChars[84] = "\u0b0a", inscriptChars[43] = "\u0b0b", inscriptChars[83] = "\u0b0f", inscriptChars[65] = "\u0b13", inscriptChars[81] = "\u0b14", inscriptChars[34] = "\u0b20", inscriptChars[44] = ",", inscriptChars[46] = ".", inscriptChars[61] = "\u0b43", inscriptChars[101] = "\u0b3e", inscriptChars[102] = "\u0b3f", inscriptChars[114] = "\u0b40", inscriptChars[103] = "\u0b41", inscriptChars[116] = "\u0b42", inscriptChars[96] = "\u0b46", inscriptChars[115] = "\u0b47", inscriptChars[93] = "\u0b3c", inscriptChars[113] = "\u0b48", inscriptChars[92] = "\u0b49", inscriptChars[97] = "\u0b4b", inscriptChars[119] = "\u0b4c", inscriptChars[88] = "\u0b01", inscriptChars[100] = "\u0b4d", inscriptChars[120] = "\u0b02", inscriptChars[45] = "\u0b03", inscriptChars[107] = "\u0b15", inscriptChars[75] = "\u0b16", inscriptChars[105] = "\u0b17", inscriptChars[73] = "\u0b18", inscriptChars[85] = "\u0b19", inscriptChars[59] = "\u0b1a", inscriptChars[58] = "\u0b1b", inscriptChars[112] = "\u0b1c", inscriptChars[80] = "\u0b1d", inscriptChars[125] = "\u0b1e", inscriptChars[39] = "\u0b1f", inscriptChars[91] = "\u0b21", inscriptChars[123] = "\u0b22", inscriptChars[67] = "\u0b23", inscriptChars[108] = "\u0b24", inscriptChars[76] = "\u0b25", inscriptChars[111] = "\u0b26", inscriptChars[79] = "\u0b27", inscriptChars[118] = "\u0b28", inscriptChars[104] = "\u0b2a", inscriptChars[72] = "\u0b2b", inscriptChars[121] = "\u0b2c", inscriptChars[89] = "\u0b2d", inscriptChars[99] = "\u0b2e", inscriptChars[106] = "\u0b30", inscriptChars[110] = "\u0b32", inscriptChars[87] = "\u0b10", inscriptChars[78] = "\u0b33", inscriptChars[98] = "\u0b71", inscriptChars[77] = "\u0b36", inscriptChars[60] = "\u0b37", inscriptChars[62] = "\u0964", inscriptChars[109] = "\u0b38", inscriptChars[117] = "\u0b39", inscriptChars[32] = " ", inscriptChars[48] = "\u0b66", inscriptChars[49] = "\u0b67", inscriptChars[50] = "\u0b68", inscriptChars[51] = "\u0b69", inscriptChars[52] = "\u0b6a", inscriptChars[53] = "\u0b6b", inscriptChars[54] = "\u0b6c", inscriptChars[55] = "\u0b6d", inscriptChars[56] = "\u0b6e", inscriptChars[57] = "\u0b6f", inscriptChars[63] = "\u0b2f", inscriptChars[47] = "\u0b5f", inscriptChars[35] = "\u0b4d\u0b30", inscriptChars[36] = "\u0b30\u0b4d", inscriptChars[37] = "\u0b1c\u0b4d\u0b1e", inscriptChars[94] = "\u0b24\u0b4d\u0b30", inscriptChars[38] = "\u0b15\u0b4d\u0b37", inscriptChars[42] = "\u0b36\u0b4d\u0b30";
var keyboards = {}, prevkey = 32,
    ppkey = 32,
    hidden = !1,
    posChanged = !0,
    isEng = !1,
    previousCons = !1,
    previouspreviousCons = !1,
    pVowel = !1,
    pppC = !1,
    isHinLetter = !1,
    lang = "or";
$(document).ready(function() {
    $('body').live('keydown', function(e) {
        if (e.keyCode == 9) {
            e.preventDefault();
            "phonetic" === $("#selectKBD")[0].value ? $("#selectKBD")[0].value = "inscript" : $("#selectKBD")[0].value = "phonetic";
            //alert($("#selectKBD")[0].value);
            //$('#inputTypeName').html($("#selectKBD")[0].value);
        }
    });

    $('#inputTypeName').html($("#selectKBD")[0].value);

    $("body").on("focus", "input:not([type]), input[type=text], input[type=search], textarea", function() {
        this.id = this.name, "english" !== $("#selectKBD")[0].value && initKBD(this.id, lang);
        var a = this.id,
            b = this;
        $(this).unbind("keypress").bind("keypress", function(b) {
            return handleKeyPress(b, keyboards[a])
        }), $(this).bind("keyup", function() {
            changeCursor(b)
        })
    })
});
